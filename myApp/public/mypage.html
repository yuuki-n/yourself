<!DOCTYPE html>
<html lang="jp">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- <link rel="stylesheet" href="post0111.css"> -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://kit.fontawesome.com/af750d91d7.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="mypage.css">

    <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/6.2.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/6.2.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/6.2.0/firebase-firestore.js"></script>
    <script src="https://cdn.firebase.com/libs/firebaseui/3.5.2/firebaseui.js"></script>
    <script src="./config.js"></script>


</head>

<body>

    <div class="wrapper">

        <header class="header_area">
            <!-- ロゴ -->
            <svg width="175" height="45" viewBox="0 0 175 45" xmlns="http://www.w3.org/2000/svg">
                <path
                    d="M20.6176 0C20.5629 0 20.5081 0.00715251 20.4534 0.00715251V19.1401L21.1513 18.3891C23.0126 16.3792 26.0235 16.0574 28.0559 17.8598C30.3756 19.934 30.4988 23.6534 28.4185 25.8992L21.2608 33.6168C21.035 33.86 20.7476 33.9816 20.4534 33.9887V42.4931C20.5081 42.4931 20.5629 42.5002 20.6176 42.5002C31.8468 42.5002 40.9479 32.9874 40.9479 21.2501C40.9479 9.51284 31.8468 0 20.6176 0Z"
                    fill="#EEE6CD" />
                <path
                    d="M19.5845 33.6168L12.4268 25.8921C10.3465 23.6462 10.4697 19.9269 12.7963 17.8527C14.8218 16.0502 17.8395 16.3721 19.7008 18.382L20.4261 19.1687L20.4946 19.0972V0.00715251C20.4398 0.00715251 20.3851 0 20.3303 0C9.10109 0 0 9.51284 0 21.2501C0 32.9874 9.10109 42.5002 20.3303 42.5002C20.3851 42.5002 20.4398 42.4931 20.4946 42.4931V33.9816C20.1661 34.0102 19.8376 33.8886 19.5845 33.6168Z"
                    fill="#D39094" />
                <path
                    d="M13.6313 13.3609C14.4098 13.3609 15.041 12.7012 15.041 11.8875C15.041 11.0737 14.4098 10.4141 13.6313 10.4141C12.8528 10.4141 12.2217 11.0737 12.2217 11.8875C12.2217 12.7012 12.8528 13.3609 13.6313 13.3609Z"
                    fill="#EEE6CD" />
                <path
                    d="M27.3169 13.3609C28.0954 13.3609 28.7265 12.7012 28.7265 11.8875C28.7265 11.0737 28.0954 10.4141 27.3169 10.4141C26.5383 10.4141 25.9072 11.0737 25.9072 11.8875C25.9072 12.7012 26.5383 13.3609 27.3169 13.3609Z"
                    fill="#D39094" />
                <path
                    d="M157.531 41.0483C160.083 43.3013 162.471 42.5718 162.998 39.1815C163.477 36.1488 163.539 33.0303 163.635 29.9404C163.737 26.7004 163.655 23.4603 163.655 20.2631C162.909 19.8626 162.109 19.555 161.459 19.04C161.123 18.7754 161.062 18.1388 160.877 17.6739C161.288 17.5237 161.684 17.302 162.102 17.2376C162.601 17.1589 163.128 17.2161 163.703 17.2161C163.874 15.943 163.963 14.677 164.216 13.4468C165.092 9.16955 168.213 6.68048 171.785 7.596C172.825 7.86064 173.803 8.74755 174.604 9.57009C175.227 10.2138 175.144 11.1222 174.145 11.6944C173.618 11.3654 173.098 10.9577 172.51 10.6859C170.231 9.60585 168.329 10.4499 167.658 12.9532C167.296 14.3051 167.207 15.7284 166.967 17.3377C168.705 17.209 170.231 17.1017 171.75 16.9944C171.983 19.4763 171.675 19.8554 169.444 19.9627C168.692 19.9985 167.946 20.07 167.036 20.1344C167.036 20.7066 167.049 21.2287 167.036 21.7508C166.851 27.151 166.796 32.5583 166.392 37.937C166.262 39.6392 165.489 41.4774 164.531 42.8936C162.93 45.2397 159.714 45.6187 157.716 44.0667C156.532 43.144 156.429 42.0639 157.531 41.0483Z"
                    fill="#423738" />
                <path
                    d="M104.026 31.3349C104.423 32.8298 103.889 33.9098 102.582 34.3962C100.707 35.09 99.5782 34.1316 98.1412 30.5911C97.7169 31.242 97.3474 31.9071 96.8958 32.5008C95.5272 34.3104 93.6864 34.947 91.613 34.3461C89.5191 33.7382 88.4995 31.9858 88.3284 29.8329C88.1984 28.1807 88.3558 26.4998 88.4105 24.8333C88.4379 23.9535 88.5679 23.0666 88.5884 22.1869C88.6432 19.8766 88.3079 19.5977 86.0566 19.8909C85.7897 19.9267 85.3107 19.7908 85.2491 19.612C85.1328 19.2973 85.1464 18.8252 85.297 18.5176C85.8171 17.4519 88.2189 16.4649 89.5396 16.7581C90.9835 17.0728 91.7704 18.1171 91.8183 19.5691C91.8799 21.4716 91.7088 23.3813 91.6609 25.2911C91.6267 26.6143 91.4693 27.9661 91.6746 29.2464C91.7909 29.976 92.4342 30.9916 93.0295 31.1704C93.7343 31.385 94.8634 31.0846 95.445 30.5696C96.9573 29.2249 97.7306 27.3796 97.8538 25.2696C97.9769 23.1167 97.9906 20.9423 98.278 18.8109C98.3738 18.0813 99.017 17.1444 99.6466 16.8368C100.933 16.2074 102.226 17.3732 102.055 18.8967C101.905 20.3058 101.522 21.6862 101.344 23.0881C101.104 24.9692 100.83 26.8646 100.81 28.76C100.803 31.292 101.569 31.8428 104.026 31.3349Z"
                    fill="#423637" />
                <path
                    d="M59.7863 20.7924C60.8265 18.5609 61.7708 16.3436 62.8862 14.2264C63.4884 13.082 64.2685 11.9805 65.1649 11.0722C66.9167 9.28405 68.7848 9.94209 69.4417 12.5456C66.3624 13.597 64.7543 16.2077 63.1736 18.9256C61.3876 21.9869 60.3133 25.134 60.9017 28.7889C61.0933 29.9763 61.0112 31.2423 60.8607 32.451C60.7101 33.6527 60.0532 34.5324 58.7188 34.5253C57.3913 34.5181 56.796 33.7742 56.9671 32.3724C57.1313 31.0062 57.2476 29.6401 57.4187 28.2811C57.7335 25.8207 57.3708 23.5032 56.1733 21.3432C54.88 19.0186 53.6688 16.6297 52.2454 14.3909C51.2395 12.8102 50.4184 12.7101 48.735 13.4397C47.866 12.4669 48.3587 11.6873 49.0566 10.9363C50.0489 9.86341 52.7587 9.72751 53.8672 10.9506C55.2084 12.424 56.4333 14.0548 57.4666 15.7785C58.3972 17.3306 59.0199 19.0973 59.7863 20.7924Z"
                    fill="#423738" />
                <path
                    d="M75.6484 16.5867C79.3846 16.5939 81.3554 17.9886 82.6624 20.4205C84.64 24.0969 83.7846 29.4899 80.8764 32.3938C77.2702 35.9915 70.701 35.1618 69.0244 29.1466C68.087 25.7992 68.5797 22.6163 70.5846 19.7911C72.0559 17.7097 74.0335 16.5367 75.6484 16.5867ZM80.3632 25.5131C80.0416 24.0754 79.8773 22.9596 79.5352 21.9082C79.0767 20.4992 78.064 19.6123 76.6269 19.4764C75.1215 19.3333 73.965 20.07 73.2602 21.4361C71.9395 23.9967 71.7821 26.6646 72.7812 29.3754C73.2807 30.7273 74.2935 31.514 75.6689 31.6356C77.0307 31.7572 78.2829 31.2351 78.8783 29.9476C79.5557 28.4814 79.9252 26.8649 80.3632 25.5131Z"
                    fill="#423637" />
                <path
                    d="M138.172 26.3214C138.165 27.9951 138.61 29.583 140.164 30.6201C142.025 31.8646 144.913 31.6071 147.574 29.9835C148.512 31.1565 147.725 32.022 146.993 32.7015C144.96 34.5897 142.524 34.9331 139.972 34.2607C136.715 33.3953 134.84 30.7202 134.525 26.7005C134.128 21.6508 137.645 17.0375 142.23 16.5797C145.405 16.265 147.828 18.2749 148.012 21.3933C148.197 24.4832 145.871 27.0724 142.757 27.0224C141.279 27.0009 139.808 26.5861 138.172 26.3214ZM138.282 24.4189C139.623 24.5118 140.916 24.6763 142.203 24.662C143.489 24.6477 144.461 23.9682 144.837 22.6236C145.173 21.4291 144.906 20.3705 143.872 19.6481C142.757 18.8685 141.607 19.0545 140.574 19.8055C139.137 20.8426 138.46 22.3589 138.282 24.4189Z"
                    fill="#433738" />
                <path
                    d="M121.92 27.9237C123.097 30.7847 124.753 32.0579 127.155 31.9792C127.62 31.9649 128.181 31.9649 128.517 31.7003C129.044 31.2926 129.707 30.6989 129.769 30.1267C129.824 29.5688 129.324 28.6962 128.825 28.3886C127.832 27.7735 126.69 27.423 125.581 27.0225C122.043 25.7565 120.647 23.2388 121.838 20.2419C123.077 17.1377 127.107 15.4068 129.879 16.9804C130.659 17.4238 131.336 18.5039 131.576 19.4265C131.829 20.4064 131.008 21.0859 129.967 21.3434C129.16 19.5696 127.785 18.7184 125.971 19.1977C125.294 19.3765 124.473 20.1704 124.302 20.8499C124.178 21.3291 124.924 22.2947 125.506 22.6523C126.587 23.3175 127.839 23.668 129.003 24.1901C130.83 24.9983 132.335 26.1356 132.369 28.453C132.404 30.7633 131.377 32.5013 129.482 33.6672C126.881 35.2765 122.68 34.783 120.955 32.6944C119.423 30.8348 119.744 29.1325 121.92 27.9237Z"
                    fill="#433839" />
                <path
                    d="M159.55 30.5197C160.323 31.5783 159.967 32.4509 159.31 33.2377C157.552 35.3334 153.959 34.897 152.919 32.3364C152.344 30.9346 152.043 29.3252 151.975 27.7946C151.708 21.6935 152.173 15.6353 153.528 9.68445C153.713 8.87622 154.506 7.68175 155.088 7.64598C155.861 7.58876 156.895 8.31832 157.442 9.02642C157.839 9.5414 157.743 10.5857 157.641 11.3581C157.538 12.1092 157.216 12.8602 156.881 13.5468C155.889 15.5924 155.362 17.7453 155.376 20.0484C155.396 22.9881 155.232 25.9421 155.458 28.8603C155.67 31.5997 156.662 32.0003 159.05 30.7128C159.167 30.6413 159.303 30.6127 159.55 30.5197Z"
                    fill="#423637" />
                <path
                    d="M111.245 21.7079C112.08 20.3703 112.751 19.09 113.613 17.9671C114.441 16.8871 115.584 16.2934 116.986 16.6653C118.287 17.0158 119.169 18.5107 118.697 19.7195C118.348 20.6278 117.965 21.5505 116.644 20.7423C115.508 20.0556 114.441 20.5706 113.647 21.5791C111.779 23.9537 111.136 26.6789 111.635 29.6972C111.745 30.3695 111.909 31.0419 111.984 31.7214C112.121 32.9301 111.307 34.2391 110.321 34.4536C109.274 34.6897 108.275 34.0102 108.166 32.5225C108.002 30.391 108.186 28.2381 108.2 26.0923C108.214 24.433 108.241 22.7664 108.18 21.1071C108.132 19.8124 107.393 19.4763 106.229 19.7552C105.853 19.8482 105.415 19.6479 105.004 19.5836C105.114 19.09 105.093 18.5035 105.353 18.1173C106.133 16.9801 107.817 16.415 109.014 16.8012C110.438 17.259 110.93 18.4106 111.033 19.8411C111.095 20.4419 111.17 21.0212 111.245 21.7079Z"
                    fill="#443839" />
            </svg>

            <p>マイページ</p>


            <!-- サインアウト -->
            <span>
                <i id="signout" class="fas fa-sign-out-alt"></i>
            </span>

        </header>

        <div class="content">

            <main>
                <div id="output" class="output"></div>
            </main>

        </div>

        <footer class="footer_area">
            <!-- ホームページ -->
            <span>
                <i id="homepage" class="fas fa-home fa-home"></i>
            </span>

            <!-- 投稿 -->
            <span>
                <i id="postpage" class="fas fa-plus-square"></i>
            </span>

            <!-- マイページ -->
            <span>
                <i id="mypage" class="fas fa-user-circle  circle"></i>
            </span>
        </footer>

    </div>

    <script>

        // cloudfirestoreの場所を定義する処理
        var db = firebase.firestore().collection('post')

        // ログインユーザーを取得する
        firebase.auth().onAuthStateChanged((user) => {
            if (user != null) {
                console.log(user);
                console.log(user.uid);
                User = firebase.auth().currentUser.uid
            }
            // 未ログイン状態で訪れた場合
            else {
                location.href = '/index.html';
            }
        });

        //  < !--  データをリアルタイムに取得する処理 'time'新しい順 desc:降順 -->
        // $('#output').css('border-radius', '50%');

        $(function () {
            db.orderBy('created_at', 'desc').onSnapshot(function (querySnapshot) {
                let str = '';
                querySnapshot.forEach(function (doc) {
                    // 現在ログインしているユーザーの投稿だけ絞り込む
                    if (User == doc.data().user_uid) {
                        // console.log(doc.id);
                        // console.log(doc.data());
                        str += '<div id="' + doc.id + '">';
                        str += '<img class="photo" src="' + doc.data().img_url + '"></img>' + doc.data().product_name;
                        // str += '<p>' + doc.data().product_name + '</p>';
                        str += '<p>' + doc.data().category + '</p>';
                        str += '<p>' + doc.data().time + '</p>';
                        str += '<p>' + doc.data().change + '</p>';
                        str += '</div>';
                        str += '<hr>';
                    }
                });

                // 現在ログインしているユーザーの投稿があれば表示、なければ「投稿なし」
                if (str == '') {
                    $('#output').html('<p>投稿がありません</p>');
                }
                else {
                    $('#output').html(str);
                }
            });
        });



        // サインアウト
        $('#signout').on('click', function () {
            // firebase.auth().onAuthStateChanged((user) => {
            firebase.auth().signOut().then(() => {
                console.log("ログアウトしました");
                location.href = '/index.html';
            });
        });

        // ホームページに遷移
        $('#homepage').on('click', function () {
            location.href = '/home.html';
        });

        // 投稿ページに遷移
        $('#postpage').on('click', function () {
            location.href = '/post.html';
        });

        // マイページはノーアクション


    </script>

</body>

</html>